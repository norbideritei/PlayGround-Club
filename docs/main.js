(()=>{"use strict";function e(e){return document.querySelector(e)}let t,n,o=[];function a(){return fetch("http://localhost:3000/bookings-json",{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>(o=e,s(e),e)))}function s(e){n!==e&&(n=e,document.querySelector("#bookings tbody").innerHTML=function(e){return e.map((({lname:e,fname:t,phone:n,peg:o,id:a})=>`\n        <tr>\n        <td>${e}</td>\n        <td>${t}</td>\n        <td>${n}</td>\n        <td>${o}</td>\n        <td>\n          <a data-id="${a}" class="remove-btn">âœ–</a>\n          <a data-id="${a}" class="edit-btn">&#9998;</a>\n        </td>\n        </tr>`)).join("")}(e))}async function d(e){e.preventDefault();const n={lname:document.getElementById("lname").value,fname:document.getElementById("fname").value,phone:document.getElementById("phone").value,peg:document.getElementById("peg").value};let a={success:!1};t?(n.id=t,a=await function(e){return fetch("http://localhost:3000/bookings-json/update",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((e=>e.json()))}(n),a.success&&(o=o.map((e=>e.id===n.id?{...e,...n}:e)))):(a=await function(e){return fetch("http://localhost:3000/bookings-json/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((e=>e.json()))}(n),a.success&&(n.id=a.id,o=[...o,n])),a.success&&(s(o),e.target.reset())}e("#editForm").classList.add("loading-mask"),a().then((async()=>{await(200,new Promise((e=>{setTimeout((()=>{e()}),200)}))),e("#editForm").classList.remove("loading-mask")})),function(){const n=e("#editForm");n.addEventListener("submit",d),n.addEventListener("reset",(e=>{t=void 0})),e("#search").addEventListener("input",function(e,t){let n;return function(){var t=this,o=arguments;clearTimeout(n),n=setTimeout((function(){e.apply(t,o)}),300)}}((e=>{var t;s((t=e.target.value,o.filter((e=>e.lname.indexOf(t)>-1))))}))),e("#bookings tbody").addEventListener("click",(async e=>{if(e.target.matches("a.remove-btn")){const t=e.target.dataset.id,n=await function(e){return fetch("http://localhost:3000/bookings-json/delete",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})}).then((e=>e.json()))}(t);n.success&&a()}else e.target.matches("a.edit-btn")&&function(e){const n=o.find((t=>t.id===e));t=e,function({lname:e,fname:t,phone:n,peg:o}){document.getElementById("lname").value=e,document.getElementById("fname").value=t,document.getElementById("phone").value=n,document.getElementById("peg").value=o}(n)}(e.target.dataset.id)}))}()})();